matrix:
  include:
  - language: java

      java: "oraclejdk8"
      env: TEST_SUITE1 = suite_oraclejdk8

      java: "oraclejdk9"
      env: TEST_SUITE2 = suite_oraclejdk9

      java: "openjdk8"
      env: TEST_SUITE2 = suite_openjdk8

    script:
      - mvn clean install -q -P linux $TEST_SUITE1
      - mvn clean install -q -P linux $TEST_SUITE2
      - mvn clean install -q -P linux $TEST_SUITE2

  - sudo: required
    language: python
    python: '2.7'
    addons:
      ssh_known_hosts: 131.234.29.7

    before_deploy:
      - sudo apt-get update -qq
      - openssl aes-256-cbc -K $encrypted_72860efd75cd_key -iv $encrypted_72860efd75cd_iv -in deploy_rsa.enc -out /tmp/deploy_rsa -d
      - eval "$(ssh-agent -s)"
      - chmod 600 /tmp/deploy_rsa
      - ssh-add /tmp/deploy_rsa

    install:
      - pip install docker-py
      - pip install ansible===2.4.0.0
    script:
      - ansible-playbook -i playbook/inventory/sask_dev.inventory playbook/deploy_microservices.yml --extra-vars "image_tag=91a1f96a418912108dc4e9f4dc5be5cf5a03e3ad"
